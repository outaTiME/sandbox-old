/*!
*              __     _
*   _    _/__  /./|,//_`
*  /_//_// /_|///  //_, v.0.9.5
*
* Copyright (c) 2012 outaTiME, Inc.
*/
function initialize(a){function j(){$("#home #box .overlay").show()}function k(){$("#home #box .overlay").hide()}function l(a,c){a=a||b||"section#place_locator",$(".tab-pane.active").scrollTo(a,400,{easing:"easeOutExpo",onAfter:c||$.noop}),b=a}function m(a,b){a.removeClass("in"),a.removeClass("out"),b===!0?a.addClass("in"):a.addClass("out")}function n(a){a.length===0?(console.info("No data..."),$("section#welcome").show()):(console.info("Yay, we got some data..."),$("form :input:visible:enabled:first").select().focus())}function o(a){var b=$("section#"+a+" .page-header span"),c=$("section#"+a+" div.page-header").outerWidth()-$("section#"+a+" div.page-header i").outerWidth()-$("section#"+a+" div.page-header button").outerWidth()-9-18;b.width(c)}function p(a){var b=[];e=new google.maps.LatLngBounds;for(var c=0;c<a.getLength();c++){var d=a.getAt(c);e.extend(d),b.push(d)}h.setPath(b)}function q(a){a=a||new google.maps.Polygon({paths:i,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,editable:!0}),a.setMap(g),google.maps.event.addListener(a.getPath(),"insert_at",function(a){console.info("Vertex inserted."),p(this)}),google.maps.event.addListener(a.getPath(),"remove_at",function(a){console.info("Vertex removed."),p(this)}),google.maps.event.addListener(a.getPath(),"set_at",function(a){console.info("Vertex moved."),p(this)}),google.maps.event.addListener(a,"rightclick",function(b){b.vertex!==null&&a.getPath().removeAt(b.vertex)})}function r(a){var b=!!a,c=b?new google.maps.LatLng(a.coords.latitude,a.coords.longitude):e.getCenter();g=new google.maps.Map(document.getElementById("map-bounds"),{zoom:10,center:c,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0});var d={strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,editable:!0},f=new google.maps.drawing.DrawingManager({drawingControl:!1,drawingControlOptions:{drawingModes:[google.maps.drawing.OverlayType.POLYGON]},polylineOptions:{editable:!0},polygonOptions:d,map:g});if(b){f.setOptions({drawingMode:google.maps.drawing.OverlayType.POLYGON});var h=google.maps.event.addListener(f,"polygoncomplete",function(a){q(a),f.setOptions({drawingMode:null}),google.maps.event.removeListener(h),p(a.getPath()),g.fitBounds(e),$("section#welcome").hide()})}else q(),g.fitBounds(e)}function s(a){j();var b=[],c=h.getPath();for(var d=0;d<c.getLength();d++){var e=c.getAt(d);b.push({lat:e.lat(),lng:e.lng()})}$.ajax({type:"POST",url:"/inout/bounds",dataType:"json",data:{bounds:[{points:b}]},error:function(a,b){},success:function(a,b,c){},complete:function(b,c){setTimeout(function(){$.isFunction(a)&&a(),k()},1e3)}})}function t(){l("section#welcome")}function u(){l("section#place_locator",function(){$("form :input:visible:enabled:first").select().focus()})}google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(a){var b=new google.maps.LatLngBounds,c=this.getPaths(),d;for(var e=0;e<c.getLength();e++){d=c.getAt(e);for(var f=0;f<d.getLength();f++)b.extend(d.getAt(f))}return b}),google.maps.Polygon.prototype.containsLatLng=function(a){var b=this.getBounds();if(b!==null&&!b.contains(a))return!1;var c=!1,d=this.getPaths().getLength();for(var e=0;e<d;e++){var f=this.getPaths().getAt(e),g=f.getLength(),h=g-1;for(var i=0;i<g;i++){var j=f.getAt(i),k=f.getAt(h);(j.lng()<a.lng()&&k.lng()>=a.lng()||k.lng()<a.lng()&&j.lng()>=a.lng())&&j.lat()+(a.lng()-j.lng())/(k.lng()-j.lng())*(k.lat()-j.lat())<a.lat()&&(c=!c),h=i}}return c};var b,c=!1,d,e=new google.maps.LatLngBounds,f,g,h,i=[];(function(){$("#home form").submit(function(a){var b=!1;$("form .control-group").removeClass("error"),a.preventDefault(),j(),$("form :input:visible:enabled:first").blur();var c=$("form .area"),g=$("form button"),i=$("#search #keywords");$.ajax({type:"GET",url:"/inout/address",data:{keywords:i.val(),bounds:e.getNorthEast().lat()+","+e.getNorthEast().lng()+"|"+e.getSouthWest().lat()+","+e.getSouthWest().lng()},error:function(a,b){},success:function(a,c,g){var i=a.results;for(var j=0;j<i.length;j++){var n=i[j],o=n.types[0],p=n.geometry.location,q=new google.maps.LatLng(p.lat,p.lng),r=$("section#view .page-header i"),s=$("section#view .page-header span"),t=$("section#view #map"),u=$(".map-container");d?d.setPosition(q):d=new google.maps.Marker({position:q,map:f,clickable:!1}),s.text(a.results[0].formatted_address);var v=h.containsLatLng(q);m(r,v),m(s,v),m(t,v),$(".inside, .outside",u).hide();if(v)f.setCenter(q),f.setZoom(16),$(".inside",u).show();else{var w=new google.maps.LatLngBounds(e.getSouthWest(),e.getNorthEast());w.extend(q);var x=google.maps.geometry.spherical.computeDistanceBetween(e.getCenter(),q)/1e3,y=$(".outside",u);$("p.small",y).text(x.toFixed(1)+"kms away"),y.show(),x>1500?(f.setCenter(q),f.setZoom(6)):f.fitBounds(w)}k(),l("#view"),b=!0;break}b===!1&&(k(),$("form .control-group").addClass("error"),$("form :input:visible:enabled:first").select().focus())}})}),$("body").on("click","#btn-welcome",function(a){$(".nav-tabs a[href='#2']").trigger("click")}),$("body").on("click","#btn-back",function(a){var b=h.getPath();!b||b.getLength()===0?(console.info("No data..."),t()):(console.info("Yay, we got some data..."),u())}),$("body").on("click","#btn-save",function(a){s()}),$("body").on("click","#btn-done",function(a){s(function(){$("section#welcome").hide(),u()})}),$("body").on("click",".nav-tabs a[data-toggle='tab']",function(a){var b=$(this).attr("href"),d=$("form .area"),e=$("form button"),h=$("#search #keywords");b==="#2"?(c===!1&&($("#map-bounds").height($("#2").outerHeight()-$("#2 .page-header").outerHeight()-18-4),c=!0,i.length===0?navigator.geolocation.watchPosition(function(a){r(a)}):r()),g&&(console.debug("We got map_bounds, resize event fired ..."),google.maps.event.trigger(g,"resize"))):google.maps.event.trigger(f,"resize")})})(),function(){var b=$(window),c=$("#box");if(!Modernizr.flexbox&&!Modernizr["flexbox-legacy"]){var d=c.closest(".container");c.bind("center",function(){var a=b.height()-d.height(),c=Math.floor(a/2);c>0&&d.css({marginTop:c})}).trigger("center"),b.resize(function(){$.doTimeout("resize",250,function(){c.trigger("center")})})}o("view"),b.resize(function(){$.doTimeout("resize",250,function(){o("view")})}),$("#map").height($("#1").outerHeight()-$("#view .page-header").outerHeight()-18-6);var f=a;if(f.length>0){var g=f[0].points;if(g.length>0)for(var h=0;h<g.length;h++){var j=g[h],k=new google.maps.LatLng(j.lat,j.lng);i.push(k),e.extend(k)}}}(),function(){f=new google.maps.Map(document.getElementById("map"),{zoom:16,center:e.getCenter(),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,minZoom:4}),google.maps.event.addListenerOnce(f,"idle",function(){n(i),k()}),h=new google.maps.Polygon({paths:i||[],strokeColor:"#0000FF",strokeOpacity:.6,strokeWeight:2,fillColor:"#0000FF",fillOpacity:.15,clickable:!1}),h.setMap(f)}()}jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?jQuery.easing.easeInBounce(a,b*2,0,d,e)*.5+c:jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*.5+d*.5+c}}),function(a){function c(a){return typeof a=="object"?a:{top:a,left:a}}var b=a.scrollTo=function(b,c,e){a(window).scrollTo(b,c,e)};b.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1},b.window=function(b){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!c)return b;var e=(b.contentWindow||b).document||b.ownerDocument||b;return a.browser.safari||e.compatMode=="BackCompat"?e.body:e.documentElement})},a.fn.scrollTo=function(e,f,g){return typeof f=="object"&&(g=f,f=0),typeof g=="function"&&(g={onAfter:g}),e=="max"&&(e=9e9),g=a.extend({},b.defaults,g),f=f||g.speed||g.duration,g.queue=g.queue&&g.axis.length>1,g.queue&&(f/=2),g.offset=c(g.offset),g.over=c(g.over),this._scrollable().each(function(){function r(a){i.animate(o,f,g.easing,a&&function(){a.call(this,e,g)})}var h=this,i=a(h),l=e,m,o={},q=i.is("html,body");switch(typeof l){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(l)){l=c(l);break}l=a(l,this);case"object":if(l.is||l.style)m=(l=a(l)).offset()}a.each(g.axis.split(""),function(a,c){var d=c=="x"?"Left":"Top",e=d.toLowerCase(),f="scroll"+d,j=h[f],n=b.max(h,c);if(m)o[f]=m[e]+(q?0:j-i.offset()[e]),g.margin&&(o[f]-=parseInt(l.css("margin"+d))||0,o[f]-=parseInt(l.css("border"+d+"Width"))||0),o[f]+=g.offset[e]||0,g.over[e]&&(o[f]+=l[c=="x"?"width":"height"]()*g.over[e]);else{var p=l[e];o[f]=p.slice&&p.slice(-1)=="%"?parseFloat(p)/100*n:p}/^\d+$/.test(o[f])&&(o[f]=o[f]<=0?0:Math.min(o[f],n)),!a&&g.queue&&(j!=o[f]&&r(g.onAfterFirst),delete o[f])}),r(g.onAfter)}).end()},b.max=function(b,c){var e=c=="x"?"Width":"Height",f="scroll"+e;if(!a(b).is("html,body"))return b[f]-a(b)[e.toLowerCase()]();var g="client"+e,h=b.ownerDocument.documentElement,i=b.ownerDocument.body;return Math.max(h[f],i[f])-Math.min(h[g],i[g])}}(jQuery),function(a){if(a)return;var b;a=window.navigator.geolocation={},a.getCurrentPosition=function(a){b&&a(b),$.getScript("//www.google.com/jsapi",function(){google.loader.ClientLocation&&(b={coords:{latitude:google.loader.ClientLocation.latitude,longitude:google.loader.ClientLocation.longitude}}),a(b)})},a.watchPosition=a.getCurrentPosition}(navigator.geolocation);