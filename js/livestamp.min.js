// Livestamp.js / v1.0.0 / (c) 2012 Matt Bradley / MIT License
(function(d,g){var h=1E3,i=!1,e=d([]),j=function(b,a){g.isMoment(a)||(a=1E3*parseFloat(a));if(!isNaN(a)||g.isMoment(a)){var c=d.extend({},{original:b.contents()},b.data("livestampdata"));c.moment=g(a);b.data("livestampdata",c).empty().removeAttr("data-livestamp").removeData("livestamp");e=e.add(b)}},k=function(){i||(f.update(),setTimeout(k,h))},f={update:function(){d("[data-livestamp]").each(function(){var a=d(this);j(a,a.data("livestamp"))});var b=[];e.each(function(){var a=d(this),c=a.data("livestampdata");
if(void 0===c)b.push(this);else if(g.isMoment(c.moment)){var e=a.html(),c=c.moment.fromNow();if(e!=c){var f=d.Event("change.livestamp");a.trigger(f,[e,c]);f.isDefaultPrevented()||a.html(c)}}});e=e.not(b)},pause:function(){i=!0},resume:function(){i=!1;k()},interval:function(b){if(void 0===b)return h;h=b}},l={add:function(b,a){if(void 0===a||a instanceof Date)a=g(a);if("number"!=typeof a&&!g.isMoment(a))return b;b.each(function(){j(d(this),a)});f.update();return b},destroy:function(b){e=e.not(b);b.each(function(){var a=
d(this),c=a.data("livestampdata");if(void 0===c)return b;a.empty().append(void 0!==c.original?c.original:"").removeData("livestampdata")});return b},isLivestamp:function(b){return void 0!==b.data("livestampdata")}};d.livestamp=f;d(function(){f.resume()});d.fn.livestamp=function(b,a){"string"!==typeof b&&(a=b,b="add");return d.isFunction(l[b])?l[b](this,a):this}})(jQuery,moment);
